# 电子邮件作者分类器

此项目使用自定义RNN与少样本训练的Bert分别尝试识别电子邮件的作者。
数据集采用https://www.cs.cmu.edu/~enron/enron_mail_20150507.tar.gz ，其中包含来自150名不同邮箱使用者的邮件。在此项目中，仅考虑已发送邮件，并只截出邮件实际内容而摒弃上下标文。经过过滤后尚有136个使用者与33269封邮件

经过训练后，RNN可达到42.5%的准确率，而Bert则可以达到60%的准确率。

由于Bert已经编码了不同层次的语言信息，这使得基于文本相似性计算进行分类的方法成为可能。所以除了分类器，我还提取了Bert输出的预测信息进行下游任务。

对于作者 $i$ 来说，一个邮件与他所写邮件的相似性应取决于他所有邮件相似性的平均值，所以有

$$s_{ij}=\frac{1}{J}\sum_{k=1}^J\frac{\vec{v}_{ij}\vec{v}_{ik}}{\|\vec{v}_{ij}\|\|\vec{v}_{ik}\|}$$

$$\text{AGS}_i \frac{1}{J}\sum_{k=1}^J s_{ik}$$

$J$ 为作者 $i$ 的邮件总数量， $\hat{v}$ 为邮件向量，$\text{AGS}_i$ 为作者 $i$ 样本邮件的平均相似度。

以此，我们可得出一未知邮件 $u$ 与作者 $i$ 的邮件的相对相似度

$$s_{iu}=\frac{1}{J}\sum_{k=1}^J\frac{\hat{v}_u\hat{v}_{ik}}{\|\hat{v}_u\|\|\hat{v}_{ik}\|}$$

当 $s_{iu}<0$ 时，意味着邮件 $u$ 与作者 $i$ 邮件的相似度低于平均相似度， $u$ 更不可能为 $i$ 所撰写。同样，如果希望为邮件 $u$ 找到一个作者，则需计算 $\forall i\in \text{authors}:\argmax_i a_{iu}$.

在此方法下，最终准确率为60%，与Bert分类器准确率持平
